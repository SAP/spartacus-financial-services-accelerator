<div class="center1400 contentPadding">
  <h2 class="heading-headline">Premium Calendar</h2>
  <ng-container *ngIf="policies$ | async as policies">
    <ng-container *ngIf="policiesLoaded$ | async; else loading">
      <div class="container-fluid">
        <div class="gradient-heading row">
          <h3 class="col"> Policy </h3>
          <h3 class="col"> Payment Frequency </h3>
          <h3 class="col"> Due Date </h3>
          <h3 class="col"> Premium </h3>
          <h3 class="col"> Payment Method </h3>
        </div>
        <ng-container *ngIf="policies?.insurancePolicies?.length > 0">
          <div *ngFor="let policy of policies.insurancePolicies">
            <div class="premium-data-row row" (click)="policy.opened=!policy.opened" [ngClass]="{'clickable': policy.billingData.length > 1}">
              <div class="col">
                <div class=row>
                  <div class="col">
                    <img class="" [src]="getBaseUrl()+ policy.mainProduct.coverageProduct.images[0].url" alt="">
                  </div>
                  <div class="col">
                    {{policy.categoryData.name}}
                    {{policy.contractNumber}}
                  </div>
                </div>
              </div>
              <div class="col">
                {{policy.paymentFrequency}}
              </div>
              <div class="col">
                {{policy.billingData[0].billingDate | date}}
              </div>
              <div class="col">
                {{policy.policyPremium.formattedValue}}
              </div>
              <div class="col">
                  {{policy.paymentMethod.paymentOption}}
              </div>
            </div>
            
            <ng-container *ngFor="let dueDate of policy.billingData | slice:1">
              <div class="premium-accordion row" *ngIf="policy.billingData.length > 1;" [ngClass]="policy.opened ? 'opened' : ''">
                <div class="col"></div>
                <div class="col"></div>
                <div class="col">
                  {{dueDate.billingDate | date}}
                </div>
                <div class="col">
                  {{dueDate.paymentAmount}}
                </div>
                <div class="col"></div>
              </div>
            </ng-container>
            
          </div>
        </ng-container>
      </div>
    </ng-container>
  </ng-container>
  <ng-template #loading>
    <cx-spinner></cx-spinner>
  </ng-template>
</div>