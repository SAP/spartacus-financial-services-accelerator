<ng-container *ngIf="quotesLoaded$ | async; else loading">
  <ng-container *ngIf="categoryConfig; else noQuotes">
    <div class="row" *ngIf="quotes$ | async as quotes">
      <div class="col-12">
        <div class="accordion">
          <ng-container>
            <cx-fs-accordion-item
              [opened]="true"
              [title]="'Quote Insured Object'"
            >
              <ul class="accordion-list container-fluid">
                <li class="accordion-list-item row sub-title">
                  <div class="col-4">
                    {{ 'Form details' }}
                  </div>
                  <div *ngFor="let cart of quotes?.carts" class="col-4">
                    {{
                      ((cart?.deliveryOrderGroups)[0]?.entries)[0]?.product
                        ?.cartDisplayName
                    }}
                  </div>
                </li>
                <ng-container
                  *ngTemplateOutlet="
                    formDataQuoteComparison;
                    context: {
                      labelList: ((quotes?.carts)[0]?.entries)[0]?.product
                        ?.configurable
                        ? (((quotes?.carts)[0]?.entries)[0]
                            ?.configurationInfos)[0]?.configurationValues?.entry
                        : ((quotes?.carts)[0].insuranceQuote?.insuredObjectList
                            ?.insuredObjects)[0]?.insuredObjectItems,
                      configurable:
                        ((quotes?.carts)[0]?.entries)[0]?.product?.configurable
                    }
                  "
                >
                </ng-container>
                <!-- <ng-container
                  *ngFor="
                    let insuredObjectItem of ((quotes?.carts)[0]?.entries)[0]
                      ?.product?.configurable
                      ? (((quotes?.carts)[0]?.entries)[0]
                          ?.configurationInfos)[0]?.configurationValues?.entry
                      : ((quotes?.carts)[0].insuranceQuote?.insuredObjectList
                          ?.insuredObjects)[0]?.insuredObjectItems;
                    index as labelIndex
                  "
                >
                  <ng-container
                    *ngIf="
                      categoryConfig?.visibleInsuredObjects.includes(
                        insuredObjectItem?.label
                          ? insuredObjectItem?.label
                          : insuredObjectItem?.key
                      )
                    "
                  >
                    <li
                      *ngIf="
                        getTranslation(
                          ((quotes?.carts)[0]?.entries)[0]?.product
                            ?.configurable
                            ? 'quoteReview'
                            : 'quote.details',
                          (((quotes?.carts)[0]?.deliveryOrderGroups)[0]
                            ?.entries)[0]?.product?.defaultCategory?.code,
                          insuredObjectItem?.label
                            ? insuredObjectItem?.label
                            : insuredObjectItem?.key
                        ) as insuredObjectItemLabel
                      "
                      class="accordion-list-item row"
                    >
                      <div class="item-label" class="col-4">
                        {{ insuredObjectItemLabel }}
                      </div>
                      <ng-container *ngFor="let cart of quotes?.carts">
                        <div class="col-4 value notice">
                          {{
                            (cart?.entries)[0]?.product?.configurable
                              ? (((cart?.entries)[0]?.configurationInfos)[0]
                                  ?.configurationValues?.entry)[labelIndex]
                                  ?.value
                              : ((cart.insuranceQuote?.insuredObjectList
                                  ?.insuredObjects)[0]?.insuredObjectItems)[
                                  labelIndex
                                ]?.value
                          }}
                        </div>
                      </ng-container>
                    </li>
                  </ng-container>
                </ng-container> -->
                <li class="accordion-list-item row sub-title">
                  <div class="col-4">
                    {{ 'Select Quote No.' }}
                  </div>
                  <div *ngFor="let cart of quotes?.carts" class="col-4">
                    {{ cart.code }}
                  </div>
                </li>
              </ul>
            </cx-fs-accordion-item>
            <cx-fs-accordion-item
              *ngIf="billingEventLabels.length > 0"
              [opened]="false"
              [title]="'Quote Billing Events'"
            >
              <ul class="accordion-list container-fluid">
                <li class="accordion-list-item row sub-title">
                  <div class="col-4">
                    {{ 'Billing Events' }}
                  </div>
                  <div *ngFor="let cart of quotes?.carts" class="col-4">
                    {{
                      ((cart?.deliveryOrderGroups)[0]?.entries)[0]?.product
                        ?.cartDisplayName
                    }}
                  </div>
                </li>
                <ng-container
                  *ngFor="let billingEventLabel of billingEventLabels"
                >
                  <li class="accordion-list-item row">
                    <div class="item-label" class="col-4">
                      {{ billingEventLabel }}
                    </div>
                    <ng-container
                      *ngFor="let cart of quotes?.carts; index as cartIndex"
                    >
                      <div class="col-4 value notice">
                        {{
                          getBillingEventValue(
                            billingEventLabel,
                            (cart?.entries)[0]?.product?.price
                              ?.oneTimeChargeEntries
                          )
                        }}
                      </div>
                    </ng-container>
                  </li>
                </ng-container>
                <li class="accordion-list-item row sub-title">
                  <div class="col-4">
                    {{ 'Select Quote No.' }}
                  </div>
                  <div *ngFor="let cart of quotes?.carts" class="col-4">
                    {{ cart.code }}
                  </div>
                </li>
              </ul>
            </cx-fs-accordion-item>
            <cx-fs-accordion-item
              [opened]="false"
              [title]="'Quote Optional Extras'"
            >
              <ul class="accordion-list container-fluid">
                <ng-container
                  *ngFor="
                    let optionalItem of (quotes?.carts)[0]?.entries | slice: 1;
                    index as i
                  "
                >
                  <li class="accordion-list-item row">
                    <div class="item-label" class="col-4">
                      {{ optionalItem?.product?.name }}
                    </div>
                    <ng-container *ngFor="let cart of quotes?.carts">
                      <div
                        *ngIf="
                          (cart?.entries)[i + 1]?.removeable &&
                          !(cart?.entries)[i + 1]?.addable
                        "
                        class="col-4 value notice"
                      >
                        {{
                          (cart?.entries)[i + 1]?.totalPrice.value
                            ? (cart?.entries)[i + 1]?.totalPrice.formattedValue
                            : ('fscommon.notIncluded' | cxTranslate)
                        }}
                      </div>
                      <div
                      *ngIf="
                        !(cart?.entries)[i + 1]?.removeable &&
                        (cart?.entries)[i + 1]?.addable
                      "
                      class="col-4 value notice"
                    >
                      {{ 'fscommon.notIncluded' | cxTranslate }}
                    </div>
                      <ng-container
                        *ngIf="
                          !(cart?.entries)[i + 1]?.removeable &&
                          !(cart?.entries)[i + 1]?.addable
                        "
                      >
                        <div
                          *ngIf="
                            (cart?.entries)[i + 1]?.product?.bundleTemplates
                              ?.length == 3
                          "
                          class="col-4 value notice"
                        >
                          {{ 'fscommon.included' | cxTranslate }}
                        </div>
                        <div
                          *ngIf="
                            (cart?.entries)[i + 1]?.product?.bundleTemplates
                              ?.length !== 3
                          "
                          class="col-4 value notice"
                        >
                          {{ 'fscommon.notAvailableFull' | cxTranslate }}
                        </div>
                      </ng-container>
                    </ng-container>
                  </li>
                </ng-container>
              </ul>
            </cx-fs-accordion-item>
          </ng-container>
        </div>
      </div>
      <ng-template
        #formDataQuoteComparison
        let-labelList="labelList"
        let-configurable="configurable"
      >
        <ng-container
          *ngFor="let insuredObjectItem of labelList; index as labelIndex"
        >
          <ng-container
            *ngIf="
              categoryConfig?.visibleInsuredObjects.includes(
                insuredObjectItem?.label || insuredObjectItem?.key
              )
            "
          >
            <li
              *ngIf="
                getTranslation(
                  configurable ? 'quoteReview' : 'quote.details',
                  categoryConfig?.categoryCode,
                  insuredObjectItem?.label || insuredObjectItem?.key
                ) as insuredObjectItemLabel
              "
              class="accordion-list-item row"
            >
              <div class="item-label" class="col-4">
                {{ insuredObjectItemLabel }}
              </div>
              <ng-container *ngFor="let cart of quotes?.carts">
                <ng-container
                  *ngTemplateOutlet="
                    formDataQuoteValueComparison;
                    context: {
                      insuredObjectItem: configurable
                        ? (((cart?.entries)[0]?.configurationInfos)[0]
                            ?.configurationValues?.entry)[labelIndex]
                        : ((cart.insuranceQuote?.insuredObjectList
                            ?.insuredObjects)[0]?.insuredObjectItems)[
                            labelIndex
                          ]
                    }
                  "
                >
                </ng-container>
              </ng-container>
            </li>
          </ng-container>
        </ng-container>
      </ng-template>
    </div>
  </ng-container>
</ng-container>
<ng-template
  #formDataQuoteValueComparison
  let-insuredObjectItem="insuredObjectItem"
>
  <div class="col-4 value notice">
    {{ insuredObjectItem?.formattedValue || insuredObjectItem?.value }}
  </div>
</ng-template>
<ng-template #noQuotes>
  <h3>{{ 'No quotes for comparison' }}</h3>
</ng-template>
<ng-template #loading>
  <cx-spinner></cx-spinner>
</ng-template>
<ng-template #noEvent>
  <div class="col-4 value notice">{{ 'no event' }}</div>
</ng-template>
