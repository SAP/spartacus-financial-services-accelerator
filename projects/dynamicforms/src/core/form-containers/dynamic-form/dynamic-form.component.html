<ng-container *ngIf="form && config">
  <div class="col-12 my-3">
    <div class="progress">
      <div
        class="progress-bar"
        [style.width]="progressBar + '%'"
        role="progressbar"
        [attr.aria-valuenow]="progressBar"
        aria-valuemin="0"
        aria-valuemax="100"
      >
        {{ progressBar }}
      </div>
    </div>
  </div>
  <form #wizardForm [ngClass]="config.cssClass" [formGroup]="form">
    <ng-container *ngFor="let formGroup of config.formGroups">
      <div
        #wizardFormGroup
        class="row"
        [ngClass]="formGroup.cssClass"
        [ngClass]="{
          'd-none': config.wizard
        }"
        [hidden]="formGroup.hidden"
      >
        <ng-container
          *ngFor="let field of formGroup.fieldConfigs"
          cxFormComponent
          [config]="field"
          [group]="
            formGroup.groupCode ? form.controls[formGroup.groupCode] : form
          "
        >
        </ng-container>
        <ng-container *ngIf="config.wizard">
          <div *ngIf="visibleIndex > 0" class="col-md-4 d-flex mt-3">
            <button
              class="btn btn-action w-100"
              type="button"
              (click)="previousSection(wizardFormGroup)"
            >
              PREVIOUS
            </button>
          </div>
          <div
            *ngIf="visibleElements.length > visibleIndex + 1"
            class="col-md-4 d-flex mt-3 ml-auto"
          >
            <button
              class="btn btn-action w-100"
              type="button"
              (click)="nextSection(wizardFormGroup, formGroup)"
            >
              NEXT
            </button>
          </div>
        </ng-container>
      </div>
    </ng-container>
    <ng-container *ngIf="populatedInvalid$ | async">
      <cx-form-popup-error></cx-form-popup-error>
    </ng-container>
  </form>
</ng-container>
